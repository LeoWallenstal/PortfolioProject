@using PortfolioProject.Models
@model ConversationViewModel

<div class="conversation-content">

	<div class="thread-header">
		<a class="back-link" href="@Url.Action("Index", "Message")">
			<i class="bi bi-arrow-left"> Chattar</i>
		</a>
		<a asp-controller="Cv" asp-action="Details" asp-route-username="@Model.OtherUsername" class="profile-link">
			<h1>@Model.OtherUsersFullName</h1>
		</a>
	</div>


	<div class="messages">
		@foreach (var msg in Model.Messages)
		{
			@if (!msg.IsMine)
			{
				<div class="received-row">
					<a asp-controller="Cv" asp-action="Details" asp-route-username="@Model.OtherUsername" class="profile-link">
						<img src="@Model.OtherUsersProfileImageUrl" />
					</a>
					<div class="received">
						<small class="timestamp">@msg.SentAt</small>
						<p>@msg.Body</p>
					</div>
				</div>
			}
			else
			{
				<div class="sent">
					<small class="timestamp">@msg.SentAt</small>
					<p>@msg.Body</p>
					<small class="read-status">
						@(msg.IsRead ? "Läst" : "Skickat")
					</small>
				</div>
			}



		}
	</div>
	<div class="send-area">
		<form asp-action="Send" asp-route-username="@Model.OtherUsername" method="post" style="display: contents;">
			<div class="text-box">
				<small id="counter">0/3500</small>
				@if (TempData["SendError"] is string error)
				{
					<div id="send-error" class="text-danger">@error</div>
				}

				<emoji-picker class="emoji-picker light" hidden></emoji-picker>
				<i class="bi bi-emoji-smile-fill emoji"></i>
				<textarea maxlength="3500" name="Body" class="input-box"></textarea>

				<button class="send-btn" type="submit">
					<i class="bi bi-send"></i>
				</button>

			</div>

		</form>
	</div>
</div>



