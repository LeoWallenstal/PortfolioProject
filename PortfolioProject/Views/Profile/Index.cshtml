@model UserViewModel

<link href="/css/profile.css" rel="stylesheet">

<h1>Min Profil</h1>

<!-- PROFILBILD NÅNSTANS -->
<section class="horizontal-container">
    <div class="img-container">
        <img class="img-wrapper"
             src="@(!string.IsNullOrWhiteSpace(Model.Cv?.ProfileImagePath)
                                               ? Url.Content(Model.Cv.ProfileImagePath)
                                               : Url.Content("~/images/default-img.png"))"
             alt="Profile picture">
    </div>
    <section class="vertical-container">
        <div class="label-w-text">
            <p class="label">Namn: </p>
            <p class="text">@($"{Model.FullName}")</p>
        </div>

        <div class="label-w-text">
            <p class="label">Användarnamn: </p>
            <p class="text">@($"{Model.UserName}")</p>
        </div>

        <div class="label-w-text">
            <p>Email: </p>
            <p>@($"{Model.Profile.Email}")</p>
        </div>

        <div class="label-w-text">
            <p>Telefonnummer: </p>
            <p>@($"{Model.Profile.PhoneNumber}")</p>
        </div>

        <div class="label-w-text">
            <p>Adress: </p>
            <p>@($"{Model.Profile.Adress}")</p>
        </div>

        <div class="label-w-checkbox">
            <label asp-for="Profile.IsPrivate">Privat profil:</label>
            <input type="checkbox" asp-for="Profile.IsPrivate" disabled>
        </div>

        <div class="button-wrapper">
            <a asp-action="EditProfile" class="btn btn-primary">Redigera Profil</a>
        </div>
    </section>
</section>

<!-- CV -->

    @if (Model.CvIsEmpty())
    {
        <section>
            <p>Ditt cv är tomt just nu!</p>
            <div class="button-wrapper">
                <a asp-action="CreateCv" class="btn btn-primary">Skapa CV</a>
            </div>
        </section>
    }
    else
    {
        <section>
            <h1>@($"{Model.Cv.Title}")</h1>
            <p class="italic-p">Antal Visningar: @($"{Model.Cv.ViewCount}")</p>
            <p>@($"{Model.Cv.Summary}")</p>
            <p>GitHub: @($"{Model.Cv.GitHubUrl}")</p>
            <p>LinkedIn: @($"{Model.Cv.LinkedInUrl}")</p>
            <hr>
            <p class="section-header">Färdigheter</p>
            <!-- SKILLS -->
        @{
            if (Model.Cv.Skills.Count > 0)
            {
                <div class="plaque-section">
                    @{
                        foreach (SkillViewModel sVm in Model.Cv.Skills)
                        {
                            <div class="plaque">
                                <img src="@(!string.IsNullOrEmpty(sVm.ImageUrl) ? sVm.ImageUrl : "../images/default-img.png")"
                                     onerror="this.src='../images/default-img.png'"
                                     class="thumbnail"
                                />
                                <p>@($"{sVm.Name}")</p>
                            </div>
                        }
                    }
                </div>
            }
            else
            {
                <p class="nothing-to-show-text">Inga färdigheter att visa!</p>
            }
        }

        <hr>
        <p class="section-header">Färdigheter</p>
        <!-- EDUCATIONS -->
        @{
            if (Model.Cv.Educations.Count > 0)
            {
                <div class="plaque-section">
                    @{
                        foreach (EducationViewModel eVm in Model.Cv.Educations)
                        {
                            <div class="plaque">
                                <p>@($"{eVm.School}")</p>
                                <p>@($"{eVm.Degree}")</p>
                                <p>@($"{eVm.StartYear.ToString("yyyy-MM-dd")} - {eVm.EndYear.ToString("yyyy-MM-dd")}")</p>
                            </div>
                        }
                    }
                </div>
            }
            else
            {
                <p class="nothing-to-show-text">Inga utbildningar att visa!</p>
            }
        }

        <hr>
        <p class="section-header">Erfarenheter</p>
        <!-- EDUCATIONS -->
        @{
            if (Model.Cv.Experiences.Count > 0)
            {
                <div class="plaque-section">
                    @{
                        foreach (ExperienceViewModel eVm in Model.Cv.Experiences)
                        {
                            <div class="plaque">
                                <p>@($"{eVm.Company}")</p>
                                <p>@($"{eVm.Role}")</p>
                                <p>@($"{eVm.StartYear.ToString("yyyy-MM-dd")} - {eVm.EndYear.ToString("yyyy-MM-dd")}")</p>
                            </div>
                        }
                    }
                </div>
            }
            else
            {
                <p class="nothing-to-show-text">Inga erfarenheter att visa!</p>
            }
        }

        <hr>
        <p class="section-header">Projekt</p>

        <div class="my-projects">
        <!-- PROJECTS -->
        @{
            if (Model.Projects.Count > 0)
            {
                <div class="projectcards row row-cols-1 row-cols-sm-1 row-cols-md-2 row-cols-lg-3 g-3 m-1 justify-content-center">
                    @foreach (var project in Model.Projects)
                    {
                        <div class="card text-center mt-2 project-card pc visible">
                            <a asp-controller="Project" asp-action="Details" asp-route-id="@project.Id" class="text-decoration-none text-reset">
                                <div class="card-header align-items-center">
                                    <h5>@project.Title</h5>
                                </div>
                                <div class="card-body">
                                    <p class="project-meta">Skapat: @project.CreatedDate.ToString("yyyy-MM-dd")</p>
                                    <p>@project.Description</p>

                                    <div class="d-flex justify-content-center mt2">
                                        @if (project.Owner == null || !project.Owner.IsActive)
                                        {
                                            <div class="participant-img col-4 col-sm-3 col-md-2 col-lg-1">
                                                <img src="/images/default-profile2.png" />
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="participant-img col-4 col-sm-3 col-md-2 col-lg-1">
                                                <img src="@project.Owner.ProfileImageUrl" />
                                            </div>
                                        }

                                        @if (project.Users.Any())
                                        {
                                            @foreach (var user in project.Users.Take(4))
                                            {
                                                if (user.IsActive && user != null)
                                                {
                                                    <div class="participant-img col-4 col-sm-3 col-md-2 col-lg-1">
                                                        <img src="@user.ProfileImageUrl" />
                                                    </div>
                                                }
                                            }
                                            @if (project.Users.Count() > 4)
                                            {
                                                <span class="ms-2 small text-muted">+@(@project.Users.Count() - 4)</span>
                                            }

                                        }
                                    </div>
                                </div>
                            </a>
                        </div>

                    }
                </div>
               
            }
            else
            {
                <p class="nothing-to-show-text">Inga projekt att visa!</p>
            }
            
        }
        <a asp-controller="Project" asp-action="Projects" class="show-all-btn"> Hantera <span class="arrow">→</span> </a>


        </div>
        <hr>

            <div class="button-wrapper">
                <a asp-action="EditCv" class="btn btn-primary">Redigera CV</a>
                <form asp-action="ExportProfile" method="post">
                    <button type="submit" class="btn btn-primary">Exportera Profil</button>
                </form>
            </div>
        </section>
    }




